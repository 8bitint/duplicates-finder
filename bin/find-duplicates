#!/usr/bin/env ruby
Dir[File.join('.', 'lib/*.rb')].each do |f|
  require f
end

arguments_parser = ArgumentsParser.new(ARGV)
unless arguments_parser.error.nil?
  puts arguments_parser.error
  exit 1
end

file_iterator = FileIterator.new
candidates_by_filesize_resolver = CandidatesByFilesizeResolver.new
duplicates_by_content_resolver = DuplicatesByDigestResolver.new
duplicates_printer = DuplicatesPrinter.new
duplicate_finder = DuplicatesFinder.new(arguments_parser.options, file_iterator, candidates_by_filesize_resolver, duplicates_by_content_resolver)

duplicate_finder.find.each do |group|
  duplicates_printer.print(group)
end
